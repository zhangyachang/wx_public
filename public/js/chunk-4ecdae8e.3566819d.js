(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4ecdae8e"],{c86c:function(e,n,o){"use strict";var t=o("d470"),a=o.n(t);a.a},d470:function(e,n,o){},da60:function(e,n,o){"use strict";o.r(n);var t=function(){var e=this,n=e.$createElement,o=e._self._c||n;return o("div",{staticClass:"add_new_app"},[o("CContentHeader",{attrs:{content:"新建Andriod应用",isShowIcon:!0}}),e.isHavaApp?e._e():o("div",{staticClass:"ana-cover-wrap"},[o("uploadApp",{attrs:{type:"apk"},on:{appFile:e.uploadFile}})],1),e.isHavaApp?o("div",{staticClass:"ana_content"},[o("div",{staticClass:"ana_content_wrap"},[o("AppInfo",{attrs:{inputmodel:e.uploadInfo.analysis_con}}),o("AppVersion",{attrs:{appinfo:e.uploadInfo.analysis_con}}),o("viewRange",{on:{allow_ranges:e.allow_ranges}}),o("AppPreviewImg",{attrs:{previews:e.uploadInfo.previews}}),o("selectLocation",{attrs:{radio:e.uploadInfo}}),o("AppAddBtn",{on:{add:e.addBtn}})],1)]):e._e(),o("div",{staticClass:"ana_loadding"})],1)},a=[],s=(o("96cf"),o("3b8d")),i=(o("7f7f"),o("1d40")),r=o("1b5b"),l=o("eb9f"),p=o("1480"),c=o("8118"),u=o("3382"),d=o("e65e"),h=o("15c6"),g=o.n(h),f=o("b1f8"),v={mixins:[f["a"]],data:function(){return{isHavaApp:!1,appFile:null,appInfoParser:{},uploadInfo:{analysis_con:{},previews:[],typeid:"",allow_ranges:[]},middleFilesResult:{appFileUrl:"",logoUrl:"",previews:[]}}},methods:{allow_ranges:function(e){var n;console.log("这里拿到选择的东西"),console.log(e);for(var o=0,t=e.length;o<t;o++){n=e[o];var a={};"dep"===n.type?(a.type="dep",a.dep=n._id):"user"===n.type?(a.type="user",a.user=n._id):(a.type="dep",a.dep=n._id),a.name=n.name,this.uploadInfo.allow_ranges.push(a)}},uploadFile:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(n){var o,t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return console.log("上传应用包之后"),console.log(n),this.appFile=n,o=new g.a(n[0]),e.next=6,o.parse();case 6:t=e.sent,console.log("分析结果"),console.log(t),console.log("打印json"),console.log(JSON.stringify(t)),this.appInfoParser=t,this.uploadInfo.version=t["versionName"]||t["CFBundleShortVersionString"],this.uploadInfo.size=(this.appFile[0].size/1024/1024).toFixed(2),this.uploadInfo.icon=t.icon,this.uploadInfo.analysis_con={packageName:t["package"]||t["CFBundleIdentifier"]||t["CFBundleName"],appName:t["application"]["label"][0],version:t["versionName"]||t["CFBundleShortVersionString"],icon:t.icon,size:(this.appFile[0].size/1024/1024).toFixed(2),build:t.CFBundleVersion||1},console.log("解析包内容"),console.log(this.uploadInfo),this.isHavaApp=!0;case 19:case"end":return e.stop()}},e,this)}));function n(n){return e.apply(this,arguments)}return n}(),uploadLogo:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.loadding=this.$zero.wholeLoadding({text:"上传logo中..."}),void 0!==this.uploadInfo.analysis_con.isBase64){e.next=7;break}return e.next=4,this.mixinBase64toUrl(this.uploadInfo.analysis_con.icon);case 4:n=e.sent,e.next=10;break;case 7:return e.next=9,this.mixinUploadImg([this.uploadInfo.analysis_con.imgFile]);case 9:n=e.sent;case 10:if(this.loadding.close(),n){e.next=13;break}return e.abrupt("return",console.log("logo上传出错了"));case 13:console.log("url路径地址"),console.log(n),this.middleFilesResult.logoUrl=n[0].file,this.createApp();case 17:case"end":return e.stop()}},e,this)}));function n(){return e.apply(this,arguments)}return n}(),uploadPreviewImg:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var n,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("获取到的图片列表"),console.log(this.uploadInfo.previews.files),e.prev=2,this.uploadInfo.previews.files&&0!==this.uploadInfo.previews.files.length){e.next=7;break}return this.$zero.ToastWarning("没有预览图片"),this.uploadLogo(),e.abrupt("return");case 7:return this.loadding=this.$zero.wholeLoadding({text:"上传预览图中.."}),e.next=10,this.mixinUploadImg(this.uploadInfo.previews.files);case 10:if(n=e.sent,this.loadding.close(),this.uploadLogo(),console.log("上传预览图结果"),console.log(n),n){e.next=17;break}return e.abrupt("return");case 17:for(o=0;o<n.length;o++)this.middleFilesResult.previews.push(n[o].file);e.next=24;break;case 20:e.prev=20,e.t0=e["catch"](2),console.log("执行过程出错了"),console.log(e.t0);case 24:case"end":return e.stop()}},e,this,[[2,20]])}));function n(){return e.apply(this,arguments)}return n}(),createApp:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var n,o,t,a=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return console.log("创建app应用"),console.log("上传的什么东西"),console.log(this.uploadInfo),console.log("应用的链接"),console.log(this.middleFilesResult),n=this.$zero.getCompany_id(),o=this.$zero.getUserid(),console.log("创建应用接口调用"),this.loadding=this.$zero.wholeLoadding({text:"上传应用信息..."}),e.next=11,this.$api.application.createAndriod({company_id:n,_name:this.uploadInfo.analysis_con.appName,typeid:this.uploadInfo.typeid,icon:this.middleFilesResult.logoUrl,description:this.uploadInfo.analysis_con.appDes,founder:o,allow_ranges:this.uploadInfo.allow_ranges,manages:[o],agentid:this.uploadInfo.analysis_con.packageName,build:"build "+this.uploadInfo.analysis_con.build,storage_url:this.middleFilesResult.appFileUrl,version:this.uploadInfo.analysis_con.version,size:this.uploadInfo.analysis_con.size+"M",previews:this.middleFilesResult.previews,package_type:""});case 11:if(t=e.sent,this.loadding.close(),console.log("上传结果"),console.log(t),75500!==t.statusCode){e.next=17;break}return e.abrupt("return",this.$zero.notify({title:"应用创建失败",message:"服务繁忙，上传失败，请稍后再试",duration:0}));case 17:if(75200===t.statusCode||75201===t.statusCode){e.next=19;break}return e.abrupt("return",this.$zero.notify({title:"应用创建失败",message:"应用创建失败，错误码:".concat(t.statusCode),duration:0}));case 19:this.$zero.notify({title:"应用创建成功",message:"新建了一个Andriod应用，可在控制台查看",duration:0}),setTimeout(function(){a.$router.go(-1)},2e3);case 21:case"end":return e.stop()}},e,this)}));function n(){return e.apply(this,arguments)}return n}(),addBtn:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return console.log("点击了创建应用按钮"),e.prev=1,this.loadding=this.$zero.wholeLoadding({text:"上传应用包中..."}),e.next=5,this.mixinUploadApp2url(this.appFile[0]);case 5:if(n=e.sent,this.loadding.close(),n){e.next=9;break}return e.abrupt("return",console.log("上传文件就出错了！"));case 9:return this.middleFilesResult.appFileUrl=n.file,e.next=12,this.uploadPreviewImg();case 12:e.next=18;break;case 14:e.prev=14,e.t0=e["catch"](1),console.log("执行过程出错了"),console.log(e.t0);case 18:case"end":return e.stop()}},e,this,[[1,14]])}));function n(){return e.apply(this,arguments)}return n}()},created:function(){this.$route.params.file&&this.uploadFile(this.$route.params.file)},components:{AppInfo:i["a"],AppVersion:r["a"],AppPreviewImg:l["a"],AppAddBtn:p["a"],uploadApp:c["a"],selectLocation:u["a"],viewRange:d["a"]}},m=v,w=(o("c86c"),o("2877")),I=Object(w["a"])(m,t,a,!1,null,null,null);n["default"]=I.exports}}]);
//# sourceMappingURL=chunk-4ecdae8e.3566819d.js.map