{"version":3,"sources":["webpack:///./src/views/c_appmanage/createH5.vue?db34","webpack:///src/views/c_appmanage/createH5.vue","webpack:///./src/views/c_appmanage/createH5.vue?79ba","webpack:///./src/views/c_appmanage/createH5.vue?b860","webpack:///./src/views/c_appmanage/createH5.vue?27ca"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","content","isShowIcon","inputmodel","uploadInfo","on","allow_ranges","radio","add","addBtn","staticRenderFns","createH5vue_type_script_lang_js_","mixins","mixinFn","data","appName","appDes","typeid","middleFilesResult","logoUrl","methods","arrAllow","item","console","log","i","length","pushObj","type","dep","_id","user","name","push","uploadLogo","_uploadLogo","Object","asyncToGenerator","regeneratorRuntime","mark","_callee","wrap","_context","prev","next","loadding","$zero","wholeLoadding","text","mixinUploadImg","imgFile","sent","close","abrupt","file","createH5","stop","apply","arguments","_createH","_callee2","company_id","user_id","uploadResult","_this","_context2","getCompany_id","getUserid","$api","application","_name","icon","description","founder","manages","statusCode","notify","title","message","duration","concat","setTimeout","$router","go","getAppDetailByid","_getAppDetailByid","_callee3","appid","_context3","_x","created","updateappid","$route","query","components","AppInfo","appInfo","AppAddBtn","appCreateBtn","selectLocation","viewRange","c_appmanage_createH5vue_type_script_lang_js_","component","componentNormalizer","__webpack_exports__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_createH5_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_createH5_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0___default","n"],"mappings":"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","file":"js/chunk-6826dcbc.81939259.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"add_new_app\"},[_c('CContentHeader',{attrs:{\"content\":\"新建H5应用\",\"isShowIcon\":true}}),_c('div',{staticClass:\"ana_content\"},[_c('div',{staticClass:\"ana_content_wrap\"},[_c('AppInfo',{attrs:{\"inputmodel\":_vm.uploadInfo}}),_c('viewRange',{on:{\"allow_ranges\":_vm.allow_ranges}}),_c('selectLocation',{attrs:{\"radio\":_vm.uploadInfo}}),_c('AppAddBtn',{on:{\"add\":_vm.addBtn}})],1)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"add_new_app\">\r\n    <CContentHeader content=\"新建H5应用\" :isShowIcon=\"true\" />\r\n\r\n    <div class=\"ana_content\">\r\n      <div class=\"ana_content_wrap\">\r\n        <AppInfo :inputmodel=\"uploadInfo\" />\r\n        <viewRange @allow_ranges=\"allow_ranges\" />\r\n        <selectLocation :radio=\"uploadInfo\" />\r\n        <AppAddBtn @add=\"addBtn\" />\r\n\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport AppInfo from \"./components/appInfo.vue\";\r\nimport AppAddBtn from \"./components/appCreateBtn\";\r\nimport selectLocation from './components/selectLocation';\r\nimport viewRange from './components/viewRange'\r\n\r\n// 公有方法合并\r\nimport myMixinFn from './mixinFn'\r\nexport default {\r\n  mixins: [myMixinFn],\r\n  data() {\r\n    return {\r\n      // 要上传的信息 传递给子组件让子组件动态改变值\r\n      uploadInfo: {\r\n        appName: \"\", // 应用名称\r\n        appDes: \"\", // 应用介绍\r\n        // previews: [], // 预览图片\r\n        typeid: '', // typeid 应用分类 (场外 户内)\r\n        allow_ranges: [], // 允许的\r\n      },\r\n\r\n      middleFilesResult: {\r\n        logoUrl: '', // logoURL地址\r\n        // previews: [], // 预览图片地址\r\n      }\r\n    };\r\n  },\r\n\r\n  methods: {\r\n    allow_ranges(arrAllow) {\r\n      console.log('这里拿到选择的东西');\r\n      console.log(arrAllow);\r\n      // 修改允许的\r\n      let item;\r\n      for (let i = 0, length = arrAllow.length; i < length; i++) {\r\n        item = arrAllow[i];\r\n        let pushObj = {};\r\n        if (item.type === 'dep') {\r\n          pushObj.type = 'dep';\r\n          pushObj.dep = item._id;\r\n        } else if (item.type === 'user') {\r\n          pushObj.type = 'user';\r\n          pushObj.user = item._id;\r\n        } else {\r\n          // 都不满足则为 企业集团\r\n          pushObj.type = 'dep';\r\n          pushObj.dep = item._id;\r\n        }\r\n        pushObj.name = item.name;\r\n        this.uploadInfo.allow_ranges.push(pushObj);\r\n      }\r\n    },\r\n\r\n    // 上传logo\r\n    async uploadLogo() {\r\n      this.loadding = this.$zero.wholeLoadding({ text: '上传logo中...' });\r\n      console.log('上传logo是什么东西');\r\n      console.log(this.uploadInfo);\r\n\r\n      let logoUrl = await this.mixinUploadImg([this.uploadInfo.imgFile]);\r\n      this.loadding.close();\r\n\r\n      if (!logoUrl) {\r\n        return console.log('logo上传出错了');\r\n      }\r\n\r\n      console.log('url路径地址');\r\n      console.log(logoUrl);\r\n\r\n      this.middleFilesResult.logoUrl = logoUrl[0].file;\r\n      // logo上传完成 上传应用的所有的一些信息\r\n      this.createH5();\r\n    },\r\n\r\n    // 创建H5应用\r\n    async createH5() {\r\n      console.log('创建函数触发');\r\n\r\n      console.log('上传的什么东西');\r\n      console.log(this.uploadInfo);\r\n      console.log('应用的链接');\r\n      console.log(this.middleFilesResult);\r\n\r\n      // 此时肯定有这个东西了 之前判断很多次了\r\n      let company_id = this.$zero.getCompany_id();\r\n      let user_id = this.$zero.getUserid();\r\n\r\n      console.log('创建应用接口调用');\r\n      // 此刻全部上传完成 调取上传应用的接口\r\n      this.loadding = this.$zero.wholeLoadding({ text: '上传应用中' });\r\n      let uploadResult = await this.$api.application.createH5({\r\n        company_id: company_id,\r\n        _name: this.uploadInfo.appName,\r\n        typeid: this.uploadInfo.typeid,\r\n        icon: this.middleFilesResult.logoUrl,\r\n        description: this.uploadInfo.appDes,\r\n        founder: user_id,\r\n        manages: [user_id],\r\n        allow_ranges: this.uploadInfo.allow_ranges\r\n      });\r\n      this.loadding.close();\r\n\r\n      console.log('上传结果');\r\n      console.log(uploadResult);\r\n\r\n      if (uploadResult.statusCode === 75500) {\r\n        return this.$zero.notify({\r\n          title: '应用创建失败',\r\n          message: `服务繁忙，上传失败，请稍后再试`,\r\n          duration: 0\r\n        });\r\n      }\r\n      if (uploadResult.statusCode !== 75200 && uploadResult.statusCode !== 75201) {\r\n        return this.$zero.notify({\r\n          title: '应用创建失败',\r\n          message: `应用创建失败，错误码:${uploadResult.statusCode}`,\r\n          duration: 0\r\n        });\r\n      }\r\n\r\n      // 新建成功\r\n      this.$zero.notify({\r\n        title: '应用创建成功',\r\n        message: '新建了一个H5应用，可在控制台查看',\r\n        duration: 0\r\n      });\r\n      setTimeout(() => {\r\n        // this.$router.push('/');\r\n        // 返回上一层\r\n        this.$router.go(-1);\r\n      }, 3000);\r\n    },\r\n\r\n\r\n    // 点击了创建应用按钮\r\n    addBtn() {\r\n      // 上传logo\r\n      this.uploadLogo();\r\n    },\r\n\r\n\r\n    // 根据id请求应用详情\r\n    async getAppDetailByid(appid) {\r\n\r\n      // let company_id = this.$zero.getCompany_id();\r\n      // let user_id = this.$zero.getUserid();\r\n      // try {\r\n      //   let appDetailResult = await this.$api.application.getAppDetail({\r\n      //     company_id,\r\n      //     user_id,\r\n      //     id: appid\r\n      //   });\r\n      //   console.log('')\r\n      //   if (appDetailResult.statusCode === 75500) {\r\n      //     return this.$zero.ToastError('服务繁忙，获取应用详情失败');\r\n      //   }\r\n      //   if (appDetailResult.statusCode !== 75200) {\r\n      //     return this.$zero.ToastError(`获取应用详情失败，错误码：${appDetailResult.statusCode}`);\r\n      //   }\r\n      //   // 获取成功\r\n      //   let appDetailResultApp = appDetailResult.app;\r\n\r\n      //   this.uploadInfo.appName = appDetailResultApp._name;\r\n      //   this.uploadInfo.appDes = appDetailResultApp.description;\r\n      //   this.uploadInfo.typeid = appDetailResultApp.typeid;\r\n      //   this.uploadInfo.allow_ranges = appDetailResultApp.allow_ranges;\r\n      //   this.uploadInfo.icon = appDetailResultApp.icon;\r\n\r\n      //   this.middleFilesResult.logoUrl = appDetailResultApp.icon;\r\n\r\n      //   console.log('走到这里了呀');\r\n      //   console.log(this.uploadInfo)\r\n\r\n      //   //   middleFilesResult: {\r\n      //   //     logoUrl: '', // logoURL地址\r\n      //   //   // previews: [], // 预览图片地址\r\n      //   // }\r\n      // } catch (error) {\r\n      //   console.log(error);\r\n\r\n      // }\r\n    }\r\n  },\r\n\r\n  created() {\r\n    console.log('crate');\r\n    let { updateappid } = this.$route.query;\r\n    if (updateappid) {\r\n      // 存在 请求数据\r\n      this.getAppDetailByid(updateappid);\r\n    }\r\n  },\r\n  components: {\r\n    AppInfo,\r\n    AppAddBtn,\r\n    selectLocation,\r\n    viewRange\r\n  }\r\n};\r\n</script>\r\n<style>\r\n.add_new_app {\r\n  height: calc(100% - 51px);\r\n}\r\n.ana_content {\r\n  margin: 20px 35px;\r\n}\r\n.ana_content_wrap {\r\n  padding: 0 40px;\r\n  background: #fff;\r\n}\r\n.ana-cover-wrap {\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./createH5.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./createH5.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./createH5.vue?vue&type=template&id=e6c27e14&\"\nimport script from \"./createH5.vue?vue&type=script&lang=js&\"\nexport * from \"./createH5.vue?vue&type=script&lang=js&\"\nimport style0 from \"./createH5.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./createH5.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./createH5.vue?vue&type=style&index=0&lang=css&\""],"sourceRoot":""}